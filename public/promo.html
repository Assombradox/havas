<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Havaianas Summer Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Nunito', sans-serif;
        }

        /* Padr√£o de Fundo "Rice Pattern" (Sola de Havaianas) */
        .havaianas-bg {
            background-color: #f8f8f8;
            background-image: radial-gradient(#e5e7eb 15%, transparent 16%), radial-gradient(#e5e7eb 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        /* Anima√ß√£o da Roleta */
        .wheel-container {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 0 auto;
            transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        /* Fatias da Roleta (Feitas com Conic Gradient para leveza) */
        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid #ffffff;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            background: conic-gradient(#ec4c33 0% 16.66%,
                    /* Tente Novamente */
                    #ffb600 16.66% 33.33%,
                    /* Frete Gr√°tis */
                    #00a7bb 33.33% 50%,
                    /* 10% OFF */
                    #ec4c33 50% 66.66%,
                    /* Tente Novamente */
                    #ffb600 66.66% 83.33%,
                    /* Brinde Surpresa */
                    #4ade80 83.33% 100%
                    /* 60% OFF (Vencedor) */
                );
            position: relative;
            transform: rotate(0deg);
        }

        /* Divis√≥rias e √çcones da Roleta */
        .wheel-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .slice-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: 0 0;
            color: white;
            font-weight: 900;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            font-size: 14px;
        }

        /* Seta Indicadora */
        .indicator {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid #333;
            z-index: 10;
            filter: drop-shadow(0 4px 2px rgba(0, 0, 0, 0.3));
        }

        /* Anima√ß√£o do Caminh√£ozinho */
        @keyframes driveIn {
            0% {
                transform: translateX(-150%);
            }

            60% {
                transform: translateX(10%);
            }

            100% {
                transform: translateX(0);
            }
        }

        .truck-anim {
            animation: driveIn 1s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        /* Anima√ß√£o de Confete no Modal Final */
        @keyframes popIn {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-content {
            animation: popIn 0.4s ease-out;
        }
    </style>
</head>

<body class="havaianas-bg text-gray-800 overflow-x-hidden min-h-screen flex flex-col">

    <header class="w-full bg-white shadow-sm py-4 text-center z-10 relative">
        <h1 class="text-2xl font-black text-[#ec4c33] tracking-tight">havaianas</h1>
        <p class="text-xs text-gray-400 font-bold uppercase tracking-widest">Summer Research 2026</p>
    </header>

    <main class="flex-grow flex flex-col items-center justify-center p-4 relative z-0">

        <div id="quiz-container"
            class="w-full max-w-md bg-white rounded-3xl shadow-xl p-6 md:p-8 transition-all duration-500">
            <div class="w-full bg-gray-100 rounded-full h-2.5 mb-6">
                <div id="progress-bar" class="bg-[#ec4c33] h-2.5 rounded-full" style="width: 20%"></div>
            </div>

            <h2 id="question-text" class="text-2xl font-bold mb-6 text-gray-800 leading-tight">Carregando...</h2>

            <div id="options-container" class="space-y-3">
            </div>
        </div>

        <div id="game-container" class="hidden w-full max-w-md flex flex-col items-center">

            <div class="text-center mb-6">
                <h2 class="text-3xl font-black text-[#ec4c33]">Hora da Sorte!</h2>
                <p class="text-gray-600">Gire para descobrir seu pr√™mio exclusivo.</p>
                <div class="mt-2 inline-block bg-yellow-100 text-yellow-800 px-4 py-1 rounded-full text-sm font-bold">
                    Chances Restantes: <span id="spins-left">3</span>
                </div>
            </div>

            <div class="relative mb-8">
                <div class="indicator"></div>
                <div class="wheel-container" id="wheel">
                    <div class="wheel">
                    </div>
                    <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                        <div
                            class="bg-white w-16 h-16 rounded-full shadow-lg z-10 flex items-center justify-center border-4 border-gray-100">
                            <i class="fa-solid fa-star text-yellow-400 text-2xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <button id="spin-btn" onclick="spinWheel()"
                class="w-full bg-[#ec4c33] text-white text-xl font-bold py-4 rounded-xl shadow-lg shadow-orange-200 hover:scale-[1.02] active:scale-95 transition-transform animate-pulse">
                GIRAR AGORA
            </button>
        </div>

    </main>

    <div id="modal-overlay"
        class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">

        <div id="modal-try-again" class="hidden bg-white w-full max-w-sm rounded-3xl p-6 text-center modal-content">
            <div class="text-6xl mb-4">üò¢</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">N√£o foi dessa vez...</h3>
            <p class="text-gray-500 mb-6">A sorte n√£o colaborou no primeiro giro. Mas n√£o desista!</p>
            <button onclick="closeModal()" class="w-full bg-gray-800 text-white font-bold py-3 rounded-xl">Tentar
                Novamente (2 chances)</button>
        </div>

        <div id="modal-shipping"
            class="hidden bg-white w-full max-w-sm rounded-3xl p-6 text-center overflow-hidden modal-content relative">
            <div class="truck-anim flex justify-center mb-4 text-[#00a7bb]">
                <i class="fa-solid fa-truck-fast text-6xl"></i>
            </div>
            <h3 class="text-2xl font-bold text-[#00a7bb] mb-2">FRETE GR√ÅTIS! üöö</h3>
            <p class="text-gray-500 mb-6">Voc√™ garantiu entrega gratuita para todo o Brasil. Vamos tentar melhorar esse
                pr√™mio?</p>
            <button onclick="closeModal()"
                class="w-full bg-[#00a7bb] text-white font-bold py-3 rounded-xl shadow-lg shadow-cyan-200">Girar √öltima
                Chance</button>
        </div>

        <div id="modal-winner"
            class="hidden bg-white w-full max-w-sm rounded-3xl p-6 text-center modal-content border-4 border-[#4ade80]">
            <div class="text-6xl mb-4 animate-bounce">üéüÔ∏è</div>
            <h3 class="text-3xl font-black text-[#ec4c33] mb-1">PARAB√âNS!</h3>
            <p class="text-gray-400 font-bold uppercase text-xs mb-4">Pr√™mio M√°ximo Desbloqueado</p>

            <div class="bg-green-50 p-4 rounded-xl border-2 border-green-200 border-dashed mb-6">
                <span class="block text-4xl font-black text-green-600">60% OFF</span>
                <span class="text-sm text-green-700 font-bold">EM TODA A LOJA</span>
            </div>

            <button onclick="showFinalSummary()"
                class="w-full bg-[#4ade80] text-white font-bold py-3 rounded-xl shadow-lg shadow-green-200 text-xl">
                RESGATAR TUDO
            </button>
        </div>

        <div id="modal-summary"
            class="hidden bg-white w-full max-w-sm rounded-3xl p-8 text-center modal-content relative overflow-hidden">
            <div class="absolute inset-0 opacity-10 pointer-events-none"
                style="background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIiBmaWxsPSIjZWM0YzMzIj48Y2lyY2xlIGN4PSIyMCIgY3k9IjIwIiByPSIyIiAvPjwvc3ZnPg==');">
            </div>

            <h2 class="text-2xl font-black text-gray-800 mb-6">RESUMO DOS PR√äMIOS</h2>

            <div class="space-y-4 mb-8">
                <div class="flex items-center bg-gray-50 p-3 rounded-xl border border-gray-100">
                    <div class="bg-cyan-100 p-2 rounded-lg text-[#00a7bb] mr-3"><i class="fa-solid fa-truck"></i></div>
                    <div class="text-left">
                        <p class="text-xs text-gray-400 font-bold uppercase">Benef√≠cio 1</p>
                        <p class="font-bold text-gray-800">Frete Gr√°tis Brasil</p>
                    </div>
                    <div class="ml-auto text-green-500"><i class="fa-solid fa-check-circle"></i></div>
                </div>

                <div class="flex items-center bg-orange-50 p-3 rounded-xl border border-orange-100">
                    <div class="bg-orange-100 p-2 rounded-lg text-[#ec4c33] mr-3"><i class="fa-solid fa-tag"></i></div>
                    <div class="text-left">
                        <p class="text-xs text-gray-400 font-bold uppercase">Benef√≠cio 2</p>
                        <p class="font-bold text-gray-800">60% de Desconto</p>
                    </div>
                    <div class="ml-auto text-green-500"><i class="fa-solid fa-check-circle"></i></div>
                </div>
            </div>

            <p class="text-xs text-gray-400 mb-2">Oferta expira em 15 minutos</p>
            <button onclick="redirectToStore()"
                class="w-full bg-[#ec4c33] text-white font-black py-4 rounded-xl shadow-xl shadow-orange-300 text-lg hover:scale-105 transition-transform">
                IR PARA A LOJA <i class="fa-solid fa-arrow-right ml-2"></i>
            </button>
        </div>

    </div>

    <script>
        // --- CONFIGURA√á√ÉO DO QUIZ ---
        let userGender = 'unisex'; // Default
        let currentQuestionIndex = 0;

        // Perguntas Din√¢micas
        const questionsMale = [
            { t: "Onde voc√™ mais usa suas Havaianas?", o: ["Churrasco e Lazer", "S√≥ dentro de casa", "Praia e Piscina"] },
            { t: "Qual seu estilo de tira preferido?", o: ["Tradicional", "Slide (Faixa)", "Power (Esportiva)"] },
            { t: "O que te faz comprar um par novo?", o: ["O antigo arrebentou", "Vi um modelo bonito", "Promo√ß√£o imperd√≠vel"] },
            { t: "Qual paleta de cores domina seu guarda-roupa?", o: ["Preto/Branco/Azul", "Cores Vibrantes", "Estampados"] }
        ];

        const questionsFemale = [
            { t: "Qual a ocasi√£o perfeita para suas Havaianas?", o: ["Look do dia a dia", "Relaxar em casa", "Areia e Mar"] },
            { t: "Qual modelo n√£o pode faltar?", o: ["Slim (Tira fina)", "Com Brilho/Glitter", "Plataforma"] },
            { t: "O que √© prioridade absoluta para voc√™?", o: ["Conforto", "Estilo e Tend√™ncia", "Durabilidade"] },
            { t: "Qual sua 'vibe' de cores para 2026?", o: ["Nude e Tons Past√©is", "Neon e Vibrante", "Met√°licos"] }
        ];

        let activeQuestions = [];

        // Inicializa√ß√£o
        function initQuiz() {
            // Pergunta 1 Fixa (Filtro)
            renderQuestion({
                t: "Para come√ßarmos, com qual linha voc√™ mais se identifica?",
                o: ["Masculina üë®", "Feminina üë©"]
            }, true);
        }

        function renderQuestion(qData, isFirst = false) {
            const container = document.getElementById('options-container');
            document.getElementById('question-text').innerText = qData.t;
            container.innerHTML = '';

            // Atualiza barra
            const total = 5;
            const pct = ((currentQuestionIndex + 1) / total) * 100;
            document.getElementById('progress-bar').style.width = `${pct}%`;

            qData.o.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-xl border-2 border-transparent bg-gray-50 hover:bg-[#ec4c33] hover:text-white hover:shadow-lg transition-all duration-200 font-bold text-lg text-gray-700 active:scale-95 mb-2";
                btn.innerText = opt;

                btn.onclick = () => {
                    if (isFirst) {
                        if (opt.includes("Masculina")) {
                            userGender = 'masculino';
                            activeQuestions = questionsMale;
                        } else {
                            userGender = 'feminino';
                            activeQuestions = questionsFemale;
                        }
                    }
                    nextQuestion();
                };
                container.appendChild(btn);
            });
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex <= activeQuestions.length) {
                renderQuestion(activeQuestions[currentQuestionIndex - 1]);
            } else {
                // Fim do Quiz -> Ir para Roleta
                document.getElementById('quiz-container').classList.add('hidden');
                document.getElementById('game-container').classList.remove('hidden');
                document.getElementById('game-container').classList.add('flex');
            }
        }

        // --- L√ìGICA DA ROLETA (RIGGED) ---
        let spins = 3;
        let currentRotation = 0;
        const wheel = document.getElementById('wheel');
        const overlay = document.getElementById('modal-overlay');

        function spinWheel() {
            if (spins === 0) return;
            spins--;
            document.getElementById('spins-left').innerText = spins;
            document.getElementById('spin-btn').disabled = true;
            document.getElementById('spin-btn').classList.add('opacity-50');

            // L√≥gica Manipulada
            // Slice Map (Baseado no Conic Gradient):
            // 0-60: Tente Novamente
            // 60-120: Frete Gr√°tis
            // 120-180: 10% OFF
            // 180-240: Tente Novamente
            // 240-300: Brinde
            // 300-360: 60% OFF (Vencedor - Verde)

            let targetDeg = 0;
            let resultType = '';

            if (spins === 2) {
                // Giro 1: Tente Novamente (Cair no vermelho 180-240)
                // Vamos mirar em 210 graus
                targetDeg = 210;
                resultType = 'loss';
            } else if (spins === 1) {
                // Giro 2: Frete Gr√°tis (Cair no amarelo 60-120)
                // Vamos mirar em 90 graus
                targetDeg = 90;
                resultType = 'shipping';
            } else {
                // Giro 3: 60% OFF (Cair no verde 300-360)
                // Vamos mirar em 330 graus
                targetDeg = 330;
                resultType = 'winner';
            }

            // Calculo da rota√ß√£o total (soma voltas completas para girar rapido)
            // Invertemos o targetDeg porque CSS rotate √© hor√°rio, e a seta est√° em cima (0deg)
            // Na verdade, se a seta ta em cima, o angulo que a seta aponta √© (360 - (rot % 360))
            // Para simplificar: Adicionamos voltas aleat√≥rias + o angulo necessario para alinhar a fatia ao topo

            // Ajuste fino: Para a fatia X ficar no topo (0deg), temos que girar: (360 - AnguloCentroFatia)
            const stopAngle = 360 - targetDeg;
            const extraSpins = 360 * (5 + Math.random() * 3); // 5 a 8 voltas
            const totalRot = currentRotation + extraSpins + stopAngle;

            // O CSS acumula a rota√ß√£o, ent√£o precisamos somar ao que j√° estava
            // Mas espera, para cair exatamente no stopAngle relativo a 0, precisamos calcular o delta
            // Vamos for√ßar o valor absoluto para facilitar

            // Simples: Setar rotation
            // Nota: Para anima√ß√£o funcionar acumulativa, temos que garantir que o valor novo > valor velho
            // Vamos fazer um hack simples: Current + Voltas + Offset Espec√≠fico

            // Offset especifico para cada premio (considerando seta no topo)
            let spinOffset = 0;
            if (resultType === 'loss') spinOffset = 210; // Red Slice
            if (resultType === 'shipping') spinOffset = 90; // Yellow Slice
            if (resultType === 'winner') spinOffset = 330; // Green Slice

            // Como a roda gira hor√°rio, para 90deg ficar no topo (0), temos que girar -90 ou 270.
            const targetRotationForCSS = (360 - spinOffset) + (360 * 5); // 5 voltas completas + alinhamento

            // Atualiza global para proximo giro somar em cima
            currentRotation += targetRotationForCSS;

            wheel.style.transform = `rotate(${currentRotation}deg)`;

            // Esperar anima√ß√£o acabar (4s)
            setTimeout(() => {
                showModal(resultType);
            }, 4000);
        }

        function showModal(type) {
            overlay.classList.remove('hidden');
            document.getElementById('modal-try-again').classList.add('hidden');
            document.getElementById('modal-shipping').classList.add('hidden');
            document.getElementById('modal-winner').classList.add('hidden');
            document.getElementById('modal-summary').classList.add('hidden');

            if (type === 'loss') {
                document.getElementById('modal-try-again').classList.remove('hidden');
            } else if (type === 'shipping') {
                document.getElementById('modal-shipping').classList.remove('hidden');
            } else if (type === 'winner') {
                document.getElementById('modal-winner').classList.remove('hidden');
            }
        }

        function closeModal() {
            overlay.classList.add('hidden');
            // Reabilitar bot√£o
            document.getElementById('spin-btn').disabled = false;
            document.getElementById('spin-btn').classList.remove('opacity-50');
        }

        function showFinalSummary() {
            document.getElementById('modal-winner').classList.add('hidden');
            document.getElementById('modal-summary').classList.remove('hidden');
        }

        function redirectToStore() {
            // AQUI EST√Å A M√ÅGICA DA FILTRAGEM
            // Redireciona para a raiz (Home) com par√¢metros
            const baseUrl = window.location.origin; // Pega o site atual
            // Se estiver testando local e quiser mandar pro localhost:3000 use: const baseUrl = "http://localhost:3000";

            window.location.href = `${baseUrl}/?coupon=DESCONTO60&gender=${userGender}&utm_source=quiz_promo`;
        }

        // Inicia
        initQuiz();

    </script>
</body>

</html>